<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Muggleâ€™s Guide to Lenormand</title>

  <!-- ğŸª„ Open Graph -->
  <meta property="og:title" content="The Muggleâ€™s Guide to Lenormand">
  <meta property="og:description" content="ë§ˆë²• ì—†ëŠ” ì„¸ìƒì˜ ë§ˆë²•ì‚¬ë“¤ì„ ìœ„í•œ í•˜ë£¨ì˜ ì˜¤ë¼í´ âœ¨">
  <meta id="ogImage" property="og:image" content="https://hie552.github.io/the-muggles-guide-to-lenormand/mgl_b_gr.png">
  <meta id="ogUrl" property="og:url" content="https://hie552.github.io/the-muggles-guide-to-lenormand/">
  <meta property="og:type" content="website">
  <meta name="theme-color" content="#2e2a4b">

  <style>
    @font-face {
      font-family: 'HarryPotter';
      src: url('HarryPotterDemoRegular.ttf') format('truetype');
    }

    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      background: url('background_0.png') no-repeat center center/cover;
      font-family: 'HarryPotter', serif;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #f4e9d8;
      text-align: center;
      overflow: hidden;
    }

    .container {
      position: relative;
      z-index: 10;
      max-width: 500px;
    }

    h1 {
      font-size: 2rem;
      letter-spacing: 2px;
      text-shadow: 0 0 10px rgba(255,255,255,0.4);
    }

    .card {
      width: 250px;
      height: 400px;
      perspective: 1000px;
      margin: 20px auto;
      cursor: pointer;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.8s;
      transform-style: preserve-3d;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-front, .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.4);
    }

    .card-back {
      background: url('mgl_b_gr.png') no-repeat center center/contain;
      background-color: rgba(20, 20, 20, 0.3);
    }

    .card-front {
      transform: rotateY(180deg);
      background-color: #1f1c2e;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 10px;
    }

    .card-front img {
      width: 100%;
      border-radius: 10px;
    }

    .message {
      margin-top: 15px;
      padding: 15px;
      border-radius: 8px;
      background: rgba(255,255,255,0.1);
      font-size: 0.95rem;
      line-height: 1.4;
      text-shadow: 0 0 5px rgba(255,255,255,0.2);
    }

    button {
      font-family: 'HarryPotter';
      font-size: 1rem;
      color: #fff;
      background: #4a3e7b;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px;
      transition: 0.3s;
    }

    button:hover {
      background: #6a56c2;
    }

    #sparkles {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      pointer-events: none;
    }

    .sparkle {
      position: absolute;
      width: 5px;
      height: 5px;
      background: gold;
      border-radius: 50%;
      animation: sparkle 1.5s linear forwards;
    }

    @keyframes sparkle {
      from { opacity: 1; transform: translateY(0); }
      to { opacity: 0; transform: translateY(-50px) scale(0.5); }
    }
  </style>
</head>
<body>
  <div id="sparkles"></div>
  <div class="container">
    <h1>The Muggleâ€™s Guide to Lenormand</h1>

    <div class="card" id="card">
      <div class="card-inner" id="cardInner">
        <div class="card-back"></div>
        <div class="card-front" id="cardFront">
          <img id="cardImage" src="" alt="">
          <div class="message" id="cardMeaning">
            <h3 id="cardTitle"></h3>
            <p id="cardKeywords"></p>
            <p id="cardDescription"></p>
          </div>
        </div>
      </div>
    </div>

    <button id="drawButton">ì˜¤ëŠ˜ì˜ ì¹´ë“œ ë³´ê¸°</button>
    <button id="shareButton" style="display:none;">ğŸ”® ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ê³µìœ </button>
    <button id="redrawButton" style="display:none;">ë‹¤ì‹œ ë½‘ê¸°</button>
  </div>

  <script>
    const baseURL = "https://hie552.github.io/the-muggles-guide-to-lenormand/";

    const cards = [
      { num: '01', name: 'RIDER', image: '01_RIDER.png',
        keywords: 'ì†Œì‹, ë°©ë¬¸ì, ìƒˆë¡œìš´ ì‹œì‘',
        meaning: 'ì¢‹ì€ ì†Œì‹ì´ë‚˜ ìƒˆë¡œìš´ ê¸°íšŒê°€ ë¹ ë¥´ê²Œ ë‹¤ê°€ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. í•´ê·¸ë¦¬ë“œì²˜ëŸ¼ ì˜ˆìƒì¹˜ ëª»í•œ ë°©ë¬¸ìë‚˜ ë©”ì‹œì§€ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª¨í—˜ì´ ë‹¹ì‹ ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”!' },
      { num: '02', name: 'CLOVER', image: '02_CLOVER.png',
        keywords: 'í–‰ìš´, ê¸°íšŒ, ë‹¨ê¸°ê°„ì˜ í–‰ë³µ',
        meaning: 'í ë¦­ìŠ¤ í ë¦¬ì‹œìŠ¤(í–‰ìš´ì˜ ë¬¼ì•½)ì²˜ëŸ¼ ì‘ì§€ë§Œ í™•ì‹¤í•œ í–‰ìš´ì´ ì°¾ì•„ì˜µë‹ˆë‹¤. ê¸°íšŒë¥¼ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”. ê¸ì •ì ì¸ íƒœë„ê°€ ë” í° í–‰ìš´ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤!' }
    ];

    const params = new URLSearchParams(window.location.search);
    const cardParam = params.get('card');

    const card = document.getElementById('card');
    const cardImage = document.getElementById('cardImage');
    const cardTitle = document.getElementById('cardTitle');
    const cardKeywords = document.getElementById('cardKeywords');
    const cardDescription = document.getElementById('cardDescription');
    const drawButton = document.getElementById('drawButton');
    const shareButton = document.getElementById('shareButton');
    const redrawButton = document.getElementById('redrawButton');
    const sparklesContainer = document.getElementById('sparkles');

    let currentCard = null;

    function createSparkles() {
      for (let i = 0; i < 30; i++) {
        setTimeout(() => {
          const sparkle = document.createElement('div');
          sparkle.className = 'sparkle';
          sparkle.style.left = Math.random() * 100 + '%';
          sparkle.style.top = Math.random() * 100 + '%';
          sparklesContainer.appendChild(sparkle);
          setTimeout(() => sparkle.remove(), 1500);
        }, i * 50);
      }
    }

    function drawCard(selected = null) {
      createSparkles();
      const randomCard = selected || cards[Math.floor(Math.random() * cards.length)];
      currentCard = randomCard;

      cardImage.src = randomCard.image;
      cardTitle.textContent = `${randomCard.num}. ${randomCard.name}`;
      cardKeywords.textContent = randomCard.keywords;
      cardDescription.textContent = randomCard.meaning;

      card.classList.add('flipped');
      drawButton.style.display = 'none';
      shareButton.style.display = 'inline-flex';
      redrawButton.style.display = 'inline-flex';

      // Open Graph ì´ë¯¸ì§€/URL ì—…ë°ì´íŠ¸
      document.querySelector('#ogImage').setAttribute('content', baseURL + randomCard.image);
      document.querySelector('#ogUrl').setAttribute('content', `${baseURL}?card=${randomCard.num}`);
    }

    function redrawCard() {
      card.classList.remove('flipped');
      drawButton.style.display = 'inline-block';
      shareButton.style.display = 'none';
      redrawButton.style.display = 'none';
      setTimeout(() => drawCard(), 400);
    }

    shareButton.addEventListener('click', () => {
      const shareUrl = `${baseURL}?card=${currentCard.num}`;
      const shareText =
        `ğŸª„ ì˜¤ëŠ˜ì˜ ì˜¤ë¼í´: ${currentCard.name}\n${currentCard.keywords}\n\n${currentCard.meaning}\n\nâœ¨ ${shareUrl}`;

      if (navigator.share) {
        navigator.share({
          title: "The Muggleâ€™s Guide to Lenormand",
          text: shareText,
          url: shareUrl
        });
      } else {
        navigator.clipboard.writeText(shareText).then(() => {
          alert("ê²°ê³¼ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•´ë³´ì„¸ìš” ğŸ’«");
        });
      }
    });

    drawButton.addEventListener('click', () => drawCard());
    redrawButton.addEventListener('click', redrawCard);

    // ì£¼ì†Œì— ?card=ë²ˆí˜¸ ìˆì„ ë•Œ ìë™ í‘œì‹œ
    if (cardParam) {
      const selectedCard = cards.find(c => c.num === cardParam);
      if (selectedCard) drawCard(selectedCard);
    }
  </script>
</body>
</html>
